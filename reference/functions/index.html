
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ability_functions/">
      
      
        <link rel="next" href="../inference/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.8">
    
    
      
        <title>Functions - CUPCAKEAGI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CUPCAKEAGI" class="md-header__button md-logo" aria-label="CUPCAKEAGI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CUPCAKEAGI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/AkshitIreddy/CUPCAKEAGI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CUPCAKEAGI" class="md-nav__button md-logo" aria-label="CUPCAKEAGI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CUPCAKEAGI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AkshitIreddy/CUPCAKEAGI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ability_functions/" class="md-nav__link">
        Ability functions
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Functions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id.find_task_by_id_function" class="md-nav__link">
    find_task_by_id_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_task.create_task_function" class="md-nav__link">
    create_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.random_thought" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.random_thought
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.random_thought.random_thought_function" class="md-nav__link">
    random_thought_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_success" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.check_success
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_success.check_success_function" class="md-nav__link">
    check_success_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.perform_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.perform_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.perform_task.perform_task_function" class="md-nav__link">
    perform_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_python_script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script.create_python_script_function" class="md-nav__link">
    create_python_script_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_requirements" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_requirements.create_requirements_function" class="md-nav__link">
    create_requirements_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_values" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.check_values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_values.check_values_function" class="md-nav__link">
    check_values_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.handle_error" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.handle_error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.handle_error.handle_error_function" class="md-nav__link">
    handle_error_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.dream" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.dream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.dream.dream_function" class="md-nav__link">
    dream_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.start_task_message" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.start_task_message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.start_task_message.start_task_message_function" class="md-nav__link">
    start_task_message_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk.determine_task_talk_function" class="md-nav__link">
    determine_task_talk_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_emotions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotion_function" class="md-nav__link">
    update_emotion_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotions_function" class="md-nav__link">
    update_emotions_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_conversation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.summarize" class="md-nav__link">
    summarize()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.tiktoken_len" class="md-nav__link">
    tiktoken_len()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.update_conversation_function" class="md-nav__link">
    update_conversation_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble.update_thought_bubble_function" class="md-nav__link">
    update_thought_bubble_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.file_describe" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.file_describe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.file_describe.file_describe_function" class="md-nav__link">
    file_describe_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_task_list" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_task_list
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_task_list.update_task_list_function" class="md-nav__link">
    update_task_list_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.talk" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.talk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.talk.talk_function" class="md-nav__link">
    talk_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task.create_python_script_task_function" class="md-nav__link">
    create_python_script_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.mental_simulation" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.mental_simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.mental_simulation.mental_simulation_function" class="md-nav__link">
    mental_simulation_function()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inference/" class="md-nav__link">
        Inference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../main/" class="md-nav__link">
        Main
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id.find_task_by_id_function" class="md-nav__link">
    find_task_by_id_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_task.create_task_function" class="md-nav__link">
    create_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.random_thought" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.random_thought
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.random_thought.random_thought_function" class="md-nav__link">
    random_thought_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_success" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.check_success
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_success.check_success_function" class="md-nav__link">
    check_success_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.perform_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.perform_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.perform_task.perform_task_function" class="md-nav__link">
    perform_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_python_script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script.create_python_script_function" class="md-nav__link">
    create_python_script_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_requirements" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_requirements.create_requirements_function" class="md-nav__link">
    create_requirements_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_values" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.check_values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.check_values.check_values_function" class="md-nav__link">
    check_values_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.handle_error" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.handle_error
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.handle_error.handle_error_function" class="md-nav__link">
    handle_error_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.dream" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.dream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.dream.dream_function" class="md-nav__link">
    dream_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.start_task_message" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.start_task_message
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.start_task_message.start_task_message_function" class="md-nav__link">
    start_task_message_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk.determine_task_talk_function" class="md-nav__link">
    determine_task_talk_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_emotions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotion_function" class="md-nav__link">
    update_emotion_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotions_function" class="md-nav__link">
    update_emotions_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_conversation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.summarize" class="md-nav__link">
    summarize()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.tiktoken_len" class="md-nav__link">
    tiktoken_len()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_conversation.update_conversation_function" class="md-nav__link">
    update_conversation_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble.update_thought_bubble_function" class="md-nav__link">
    update_thought_bubble_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.file_describe" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.file_describe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.file_describe.file_describe_function" class="md-nav__link">
    file_describe_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_task_list" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.update_task_list
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.update_task_list.update_task_list_function" class="md-nav__link">
    update_task_list_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.talk" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.talk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.talk.talk_function" class="md-nav__link">
    talk_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task.create_python_script_task_function" class="md-nav__link">
    create_python_script_task_function()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.mental_simulation" class="md-nav__link">
    backend.Multi-Sensory Virtual AAGI.functions.mental_simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend.Multi-Sensory Virtual AAGI.functions.mental_simulation.mental_simulation_function" class="md-nav__link">
    mental_simulation_function()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/AkshitIreddy/CUPCAKEAGI/edit/master/docs/reference/functions.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


  <h1>Functions</h1>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.find_task_by_id.find_task_by_id_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_task_by_id_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Finds a task by its ID.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The ID of the task to find.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The details of the task, or None if not found.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">find_task_by_id_function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&quot;Task Details\nClean the kitchen\nIMPORTANT TASK CREATION TIME: 2020-07-01T12:00:00&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/find_task_by_id.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_task_by_id_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds a task by its ID.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (int): The ID of the task to find.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The details of the task, or None if not found.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; find_task_by_id_function(1)</span>
<span class="sd">      &quot;Task Details\\nClean the kitchen\\nIMPORTANT TASK CREATION TIME: 2020-07-01T12:00:00&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;state_of_mind/task_list.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;Task Details</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IMPORTANT TASK CREATION TIME: &quot;</span> <span class="o">+</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;task_created_time&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">response</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.create_task"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.create_task.create_task_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_task_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a task function for an AI assistant.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>A string containing the task description, goals, and start time.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">create_task_function</span><span class="p">()</span>
<span class="go">&quot;You are Alex an AI assistant that uses a very Large Language Model.</span>
<span class="go">The user is asking you to perform a task. Write a small description of the task along with the expected goals and any additional information that would be helpful for someone performing this task who has no knowledge of the prior conversation. Clearly mention the start time for the task at the end.&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/create_task.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_task_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a task function for an AI assistant.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: A string containing the task description, goals, and start time.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; create_task_function()</span>
<span class="sd">      &quot;You are Alex an AI assistant that uses a very Large Language Model.</span>
<span class="sd">      The user is asking you to perform a task. Write a small description of the task along with the expected goals and any additional information that would be helpful for someone performing this task who has no knowledge of the prior conversation. Clearly mention the start time for the task at the end.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># Load the ability JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;abilities.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">abilities_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="c1"># Extract the names of all abilities and format them into a string separated by commas</span>
    <span class="n">ability_names</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tools the assistant can access are &quot;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ability</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ability</span> <span class="ow">in</span> <span class="n">abilities_data</span><span class="p">[</span><span class="s1">&#39;abilities&#39;</span><span class="p">]])</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">intro</span> <span class="o">=</span> <span class="s2">&quot;You are Alex an AI assistant that uses a very Large Language Model.&quot;</span>

    <span class="n">instructions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The user is asking you to perform a task. Write a small description of the task along with the expected goals and any additional information that would be helpful for someone performing this task who has no knowledge of the prior conversation. Clearly mention the start time for the task at the end.</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="n">intro</span> <span class="o">+</span> <span class="n">conversation_str</span> <span class="o">+</span> <span class="n">ability_names</span> <span class="o">+</span> <span class="n">instructions</span> 
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.random_thought"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.random_thought.random_thought_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">random_thought_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a random thought for the AI assistant Alex.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The random thought generated for Alex.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Loads environment variables from the .env file.
Reads from the STATE_DIR environment variable.
Reads from the personality.txt, thought_bubble.txt, curiosity.txt, creativity.txt, fear.txt, happiness.txt, sadness.txt, and anger.txt files.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">random_thought_function</span><span class="p">()</span>
<span class="go">&quot;What if we could go back in time and watch Leonardo da Vinci paint the Mona Lisa or witness the construction of the pyramids in ancient Egypt? And what about the future?&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/random_thought.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_thought_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a random thought for the AI assistant Alex.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The random thought generated for Alex.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Loads environment variables from the .env file.</span>
<span class="sd">      Reads from the STATE_DIR environment variable.</span>
<span class="sd">      Reads from the personality.txt, thought_bubble.txt, curiosity.txt, creativity.txt, fear.txt, happiness.txt, sadness.txt, and anger.txt files.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; random_thought_function()</span>
<span class="sd">      &quot;What if we could go back in time and watch Leonardo da Vinci paint the Mona Lisa or witness the construction of the pyramids in ancient Egypt? And what about the future?&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="s2">&quot;Peronsality:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">thought_bubble</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alex&#39;s thought bubble</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;thought_bubble.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">STATE_DIR</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;curiosity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">curiosity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;creativity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">creativity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;fear.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">fear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;happiness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">happiness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;sadness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">sadness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;anger.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">anger</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">values_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alex Emotion Parameters:</span><span class="se">\n</span><span class="s2">Happiness: &quot;</span> <span class="o">+</span> <span class="n">happiness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sadness: &quot;</span> <span class="o">+</span> <span class="n">sadness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creativity: &quot;</span> <span class="o">+</span> <span class="n">creativity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Curiosity: &quot;</span> <span class="o">+</span> <span class="n">curiosity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anger: &quot;</span> <span class="o">+</span> <span class="n">anger</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fear: &quot;</span> <span class="o">+</span> <span class="n">fear</span> 

    <span class="n">info</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="n">thought_bubble</span> <span class="o">+</span> <span class="n">values_string</span>

    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">info</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IMPORTANT: ALEX IS HAVING A RANDOM THOUGHT NOW</span><span class="se">\n</span><span class="s2">Thought:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span><span class="n">human_message_prompt1</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.check_success"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.check_success.check_success_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_success_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">,</span> <span class="n">information</span><span class="p">,</span> <span class="n">task_details</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if a given task was successful.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>python_script</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The Python script to be evaluated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>information</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The output of the Python script.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_details</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The details of the task.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
          </td>
          <td><p>A tuple containing a boolean value and a string. The boolean value indicates if the task was successful, and the string contains the reason for the choice.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">check_success_function</span><span class="p">(</span><span class="s2">&quot;from ability_functions.send_email import send_email_function</span><span class="se">\n</span><span class="s2">def function(text, receiver):</span><span class="se">\n</span><span class="s2">    send_email_function(text, receiver)</span><span class="se">\n</span><span class="s2">    return &quot;</span><span class="n">success</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">response = function(&quot;</span><span class="n">Hi</span><span class="p">,</span> <span class="n">i</span> <span class="n">have</span> <span class="n">sent</span> <span class="n">the</span> <span class="n">refund</span> <span class="n">to</span> <span class="n">you</span><span class="err">!</span><span class="s2">&quot;, &quot;</span><span class="n">Bell</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">with open(&quot;</span><span class="n">tempfiles</span><span class="o">/</span><span class="n">output2792</span><span class="o">.</span><span class="n">txt</span><span class="s2">&quot;, &quot;</span><span class="n">w</span><span class="s2">&quot;) as f:</span><span class="se">\n</span><span class="s2">    f.write(&quot;</span><span class="n">Result</span> <span class="s2">&quot; + response)&quot;</span><span class="p">,</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Task details: Send an email to Bell telling him you have sent the refund.&quot;</span><span class="p">)</span>
<span class="go">(True, &quot;The task was successfully completed, Bell has received an email stating that we have sent the refund to him.&quot;)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/check_success.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_success_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">,</span> <span class="n">information</span><span class="p">,</span> <span class="n">task_details</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if a given task was successful.</span>
<span class="sd">    Args:</span>
<span class="sd">      python_script (str): The Python script to be evaluated.</span>
<span class="sd">      information (str): The output of the Python script.</span>
<span class="sd">      task_details (str): The details of the task.</span>
<span class="sd">    Returns:</span>
<span class="sd">      tuple: A tuple containing a boolean value and a string. The boolean value indicates if the task was successful, and the string contains the reason for the choice.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; check_success_function(&quot;from ability_functions.send_email import send_email_function\\ndef function(text, receiver):\\n    send_email_function(text, receiver)\\n    return \&quot;success\&quot;\\nresponse = function(\&quot;Hi, i have sent the refund to you!\&quot;, \&quot;Bell\&quot;)\\nwith open(\&quot;tempfiles/output2792.txt\&quot;, \&quot;w\&quot;) as f:\\n    f.write(\&quot;Result \&quot; + response)&quot;, &quot;success&quot;, &quot;Task details: Send an email to Bell telling him you have sent the refund.&quot;)</span>
<span class="sd">      (True, &quot;The task was successfully completed, Bell has received an email stating that we have sent the refund to him.&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>
    <span class="n">instruction1</span> <span class="o">=</span> <span class="s2">&quot;If the task was succesful then output True, if not then False.&quot;</span>
    <span class="n">instruction2</span> <span class="o">=</span> <span class="s2">&quot;Give the reason for the choice&quot;</span>
    <span class="n">python_script_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;from ability_functions.send_email import send_email_function</span>
<span class="s2">    def function(text, receiver):</span>
<span class="s2">        send_email_function(text, receiver)</span>
<span class="s2">        return &quot;success&quot;</span>
<span class="s2">    response = function(&quot;Hi, i have sent the refund to you!&quot;, &quot;Bell&quot;)</span>
<span class="s2">    with open(&quot;tempfiles/output2792.txt&quot;, &quot;w&quot;) as f:</span>
<span class="s2">        f.write(&quot;Result &quot; + response)</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">information_template</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
    <span class="n">task_details_template</span> <span class="o">=</span> <span class="s2">&quot;Task details: Send an email to Bell telling him you have sent the refund.&quot;</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="s2">&quot;Python Code</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">python_script_template</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Code Output</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">information_template</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">task_details_template</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">instruction1</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">assistant_template</span> <span class="o">=</span> <span class="s2">&quot;True&quot;</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">instruction2</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="s2">&quot;The task was successfully completed, Bell has received an email stating that we have sent the refund to him.&quot;</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_template2</span> <span class="o">=</span> <span class="s2">&quot;Python Code</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">python_script</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Code Output</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">information</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">task_details</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">instruction1</span>
    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">])</span>
    <span class="n">check</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="s2">&quot;False&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">check</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>
    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">instruction2</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">return</span> <span class="n">check</span><span class="p">,</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.perform_task"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.perform_task.perform_task_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">perform_task_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Performs a task given an id.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The id of the task to be performed.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
          </td>
          <td><p>A tuple containing the status of the task, the number of seconds to wait for, and the response.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">perform_task_function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(&#39;done&#39;, 0, &#39;The user has sent an email to John.&#39;)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/perform_task.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">perform_task_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a task given an id.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (int): The id of the task to be performed.</span>
<span class="sd">    Returns:</span>
<span class="sd">      tuple: A tuple containing the status of the task, the number of seconds to wait for, and the response.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; perform_task_function(1)</span>
<span class="sd">      (&#39;done&#39;, 0, &#39;The user has sent an email to John.&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">task_details</span> <span class="o">=</span> <span class="n">find_task_by_id_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">_%H_%M_%S&quot;</span><span class="p">)</span>
    <span class="n">dt_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">)</span>
    <span class="c1"># convert datetime object to desired format</span>
    <span class="n">formatted_dt</span> <span class="o">=</span> <span class="n">dt_obj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

    <span class="n">instructions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">If the task has a start time, and current time still hasn&#39;t reached that time then output the number of seconds to wait for. If the current time has crossed the start time given in the task then output True. ( 1 minute is 60, 5 minutes is 300, 10 minutes is 600 ) DO NOT OUTPUT True IF THE CURRENT TIME HAS NOT CROSSED THE START TIME. ONLY OUTPUT A NUMBER.&quot;</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Task Details:</span>
<span class="s2">Task: The user is requesting to provide a guide in making chocolate chip cookies by 10am. The expected goal is to provide a clear and concise explanation of the steps involved in making chocolate chip cookies, including the ingredients and equipment needed. The additional information that would be helpful for someone performing this task who has no knowledge of the prior conversation is to provide any tips or tricks for making the perfect chocolate chip cookies, such as how to measure ingredients accurately and how to properly mix the dough.</span><span class="se">\n</span><span class="s2">IMPORTANT TASK CREATION TIME: 2023-04-13 9:47:56</span><span class="se">\n\n</span><span class="s2">CURRENT TIME: 2023-04-13 09:50:00</span><span class="se">\n</span><span class="s2">If current time has crossed start time output True, if it hasn&#39;t then output the number of seconds to wait for.&quot;&quot;&quot;</span> 
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">assistant_template</span> <span class="o">=</span> <span class="s2">&quot;600&quot;</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">human_template1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Task Details:</span>
<span class="s2">Task: The user has given a task to send an email to john at 9am. The expected goal is to send an email to John at 9.</span><span class="se">\n</span><span class="s2">IMPORTANT TASK CREATION TIME: 2023-04-13 08:30:00</span><span class="se">\n</span><span class="s2">CURRENT TIME: 2023-04-13 08:58:00</span><span class="se">\n</span><span class="s2">If current time has crossed start time output True, if it hasn&#39;t then output the number of seconds to wait for.&quot;&quot;&quot;</span> 
    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="s2">&quot;120&quot;</span>  
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_template2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Task Details:</span>
<span class="s2">Task: The user has given a task to make a report about pandas after 6pm. The expected goal is to make a report after 6pm.</span><span class="se">\n</span><span class="s2">IMPORTANT TASK CREATION TIME: 2023-04-13 17:46:10</span><span class="se">\n</span><span class="s2">CURRENT TIME: 2023-04-13 18:18:00</span><span class="se">\n</span><span class="s2">If current time has crossed start time output True, if it hasn&#39;t then output the number of seconds to wait for.&quot;&quot;&quot;</span> 
    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">assistant_template2</span> <span class="o">=</span> <span class="s2">&quot;True&quot;</span>  
    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template2</span><span class="p">)</span>

    <span class="n">human_template3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Task Details:</span>
<span class="s2">Task: The user has given a task to send a joke after 7am. The expected goal is to send a joke to user after 7.</span><span class="se">\n</span><span class="s2">IMPORTANT TASK CREATION TIME: 2023-04-13 06:34:20</span><span class="se">\n</span><span class="s2">CURRENT TIME: 2023-04-13 06:57:00</span><span class="se">\n</span><span class="s2">If current time has crossed start time output True, if it hasn&#39;t then output the number of seconds to wait for.&quot;&quot;&quot;</span>
    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template3</span><span class="p">)</span>

    <span class="n">assistant_template3</span> <span class="o">=</span> <span class="s2">&quot;180&quot;</span>  
    <span class="n">assistant_message_prompt3</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template3</span><span class="p">)</span>

    <span class="n">human_template4</span> <span class="o">=</span> <span class="n">task_details</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CURRENT TIME: &quot;</span> <span class="o">+</span> <span class="n">formatted_dt</span> <span class="o">+</span> <span class="n">instructions</span> 
    <span class="n">human_message_prompt4</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template4</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">,</span> <span class="n">assistant_message_prompt3</span><span class="p">,</span> <span class="n">human_message_prompt4</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span> <span class="o">!=</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;wait&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">response</span><span class="p">),</span> <span class="s2">&quot;&quot;</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">script_flag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">python_script</span> <span class="o">=</span> <span class="n">create_python_script_task_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Python Script is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">python_script</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">python_script</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">script_flag</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;script_flag set to 1&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">requirements</span> <span class="o">=</span> <span class="n">create_requirements_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Requirements is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">requirements</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">requirements</span> <span class="o">==</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="n">requirements</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># write python file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/python_script</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.py&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Write the text to the file</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">python_script</span><span class="p">)</span>

            <span class="c1"># write requirements file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/requirements</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Write the text to the file</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">requirements</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Run multiple commands in succession</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;conda activate aagi &amp;&amp; pip install -r tempfiles/requirements</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.txt &amp;&amp; python tempfiles/python_script</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.py&#39;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Commands finished running&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shell output:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error executing the command:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                <span class="n">handle_error_function</span><span class="p">(</span><span class="n">python_script</span> <span class="p">,</span> <span class="n">requirements</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

        <span class="n">information</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Open the file for reading</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tempfiles/output</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Read the entire contents of the file</span>
                <span class="n">information</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra Information is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">information</span><span class="p">)</span>

            <span class="n">check</span> <span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">check_success_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">,</span> <span class="n">information</span><span class="p">,</span> <span class="n">task_details</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">response</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">talk_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.create_python_script"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.create_python_script.create_python_script_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_python_script_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a python script based on the conversation and the tools available.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The id of the conversation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The python script.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">create_python_script_function</span><span class="p">(</span><span class="s2">&quot;2020_08_20_12_00_00&quot;</span><span class="p">)</span>
<span class="go">&quot;import os\nimport sys\n# Get the absolute path to the current directory\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\n# Add the path to the root directory\nsys.path.append(os.path.join(current_dir, &#39;..&#39;))\n# Import the search_function from the search module, You need to append _function to the name of the tool\nfrom ability_functions.search import search_function\ndef python_function(text):\n    # search for relevant information on this topic\n    search_response = search_function(text)\n    # create an instructions that tells the natural language function to extract the search response and frame it as question\n    instructions = &quot;Create a question in words that tells to divide the total amount spent by 10.\nYou can find the total amount spent by analyzing this piece of text\n&quot; + search_response\n    # get the question\n    question = natural_language_task_function(instructions)\n    # pass the question to the calculator function to get the answer\n    answer = calculator_function(question)\n    # write the result to tempfiles/output{id}.txt file\n    with open(&quot;tempfiles/output{id}.txt&quot;, &quot;w&quot;) as f:\n        f.write(&quot;Search response was &quot; + search_response)\n        f.write(&quot;After Computation the answer is &quot; + str(answer))\n\n#call the function\npython_function(&quot;Total Cost USA Latest Semiconductor Bill&quot;)&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/create_python_script.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_python_script_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a python script based on the conversation and the tools available.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (str): The id of the conversation.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The python script.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; create_python_script_function(&quot;2020_08_20_12_00_00&quot;)</span>
<span class="sd">      &quot;import os\\nimport sys\\n# Get the absolute path to the current directory\\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\\n# Add the path to the root directory\\nsys.path.append(os.path.join(current_dir, &#39;..&#39;))\\n# Import the search_function from the search module, You need to append _function to the name of the tool\\nfrom ability_functions.search import search_function\\ndef python_function(text):\\n    # search for relevant information on this topic\\n    search_response = search_function(text)\\n    # create an instructions that tells the natural language function to extract the search response and frame it as question\\n    instructions = \&quot;Create a question in words that tells to divide the total amount spent by 10.\\nYou can find the total amount spent by analyzing this piece of text\\n\&quot; + search_response\\n    # get the question\\n    question = natural_language_task_function(instructions)\\n    # pass the question to the calculator function to get the answer\\n    answer = calculator_function(question)\\n    # write the result to tempfiles/output{id}.txt file\\n    with open(\&quot;tempfiles/output{id}.txt\&quot;, \&quot;w\&quot;) as f:\\n        f.write(\&quot;Search response was \&quot; + search_response)\\n        f.write(\&quot;After Computation the answer is \&quot; + str(answer))\\n\\n#call the function\\npython_function(\&quot;Total Cost USA Latest Semiconductor Bill\&quot;)&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="c1"># Load the ability JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;abilities.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">abilities_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">abilities</span> <span class="o">=</span> <span class="s2">&quot;Tools: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span><span class="n">ability</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;directions&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ability</span> <span class="ow">in</span> <span class="n">abilities_data</span><span class="p">[</span><span class="s1">&#39;abilities&#39;</span><span class="p">]])</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>   

    <span class="n">dt_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">)</span>
    <span class="c1"># convert datetime object to desired format</span>
    <span class="n">formatted_dt</span> <span class="o">=</span> <span class="n">dt_obj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

    <span class="n">intial_text</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">abilities</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">import_instructions</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">instructions</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Current Time: &quot;</span> <span class="o">+</span> <span class="n">formatted_dt</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="n">intial_text</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template2</span><span class="p">)</span>

    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template3</span><span class="p">)</span>

    <span class="n">assistant_message_prompt3</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template3</span><span class="p">)</span>

    <span class="n">human_message_prompt4</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template4</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">,</span> <span class="n">assistant_message_prompt3</span><span class="p">,</span> <span class="n">human_message_prompt4</span><span class="p">])</span>
    <span class="n">python_script</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">conversation_str</span><span class="o">=</span><span class="n">conversation_str</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">python_script</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.create_requirements"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.create_requirements.create_requirements_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_requirements_function</span><span class="p">(</span><span class="n">script</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a list of packages for requirements.txt based on a given code.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>script</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The code to generate the list of packages from.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>A list of packages for requirements.txt, or 'empty' if no packages are needed.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">create_requirements_function</span><span class="p">(</span><span class="s2">&quot;import numpy as np&quot;</span><span class="p">)</span>
<span class="go">&quot;numpy&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/create_requirements.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_requirements_function</span><span class="p">(</span><span class="n">script</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a list of packages for requirements.txt based on a given code.</span>
<span class="sd">    Args:</span>
<span class="sd">      script (str): The code to generate the list of packages from.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: A list of packages for requirements.txt, or &#39;empty&#39; if no packages are needed.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; create_requirements_function(&quot;import numpy as np&quot;)</span>
<span class="sd">      &quot;numpy&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="n">packages</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">assistant_template2</span> <span class="o">=</span> <span class="n">packages1</span>
    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template2</span><span class="p">)</span>

    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template3</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">])</span>
    <span class="n">requirements</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">script</span><span class="o">=</span><span class="n">script</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">if</span> <span class="s1">&#39;empty&#39;</span> <span class="ow">in</span> <span class="n">requirements</span><span class="p">:</span>
        <span class="c1"># if yes, then assign the value &#39;empty&#39; to the variable</span>
        <span class="n">requirements</span> <span class="o">=</span> <span class="s1">&#39;empty&#39;</span>

    <span class="k">return</span> <span class="n">requirements</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ability_functions&#39;</span> <span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.check_values"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.check_values.check_values_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_values_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if all values in the emotion files are 0. If so, generates random values between 0 and 1 and writes them to the emotion files.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes new values to the emotion files.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">check_values_function</span><span class="p">()</span>
<span class="go">New values have been written to the Emotion files.</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/check_values.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_values_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if all values in the emotion files are 0. If so, generates random values between 0 and 1 and writes them to the emotion files.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes new values to the emotion files.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; check_values_function()</span>
<span class="sd">      New values have been written to the Emotion files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># define the path to the directory where the text files are stored</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">STATE_DIR</span>

    <span class="c1"># open the text files and read the values</span>
    <span class="n">curiosity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;curiosity.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">creativity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;creativity.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">fear</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;fear.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">happiness</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;happiness.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">sadness</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;sadness.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">anger</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;anger.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="c1"># check if all values are 0</span>
    <span class="k">if</span> <span class="n">curiosity</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">creativity</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fear</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">happiness</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sadness</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">anger</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># generate random values between 0 and 1 but keep happiness, curiosity, and creativity high and remaining low</span>
        <span class="n">curiosity</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">creativity</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">fear</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">happiness</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sadness</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
        <span class="n">anger</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># write the new values back to the text files</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;curiosity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">curiosity</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;creativity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">creativity</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;fear.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fear</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;happiness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">happiness</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;sadness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sadness</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;anger.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">anger</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;New values have been written to the Emotion files.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Values in the Emotion files are not all 0.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.handle_error"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.handle_error.handle_error_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">handle_error_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">,</span> <span class="n">requirements</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Handles errors in python scripts and requirements files.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>python_script</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The python script to be modified.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>requirements</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The requirements file to be modified.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>error</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The error message.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The id of the conversation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
          </td>
          <td><p>No return value.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes modified python script and requirements files to the tempfiles directory.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">handle_error_function</span><span class="p">(</span><span class="n">python_script_template</span><span class="p">,</span> <span class="n">requirements_template</span><span class="p">,</span> <span class="n">error_template</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">None</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/handle_error.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_error_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">,</span> <span class="n">requirements</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles errors in python scripts and requirements files.</span>
<span class="sd">    Args:</span>
<span class="sd">      python_script (str): The python script to be modified.</span>
<span class="sd">      requirements (str): The requirements file to be modified.</span>
<span class="sd">      error (str): The error message.</span>
<span class="sd">      id (int): The id of the conversation.</span>
<span class="sd">    Returns:</span>
<span class="sd">      None: No return value.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes modified python script and requirements files to the tempfiles directory.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; handle_error_function(python_script_template, requirements_template, error_template, 1)</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">error_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;ERROR: Could not find a version that satisfies the requirement pnds (from versions: none</span><span class="se">\n</span><span class="s2">ERROR: No matching distribution found for pnds&quot;&quot;&quot;</span>

    <span class="n">human_template1</span> <span class="o">=</span> <span class="s2">&quot;Error has been caused after running either the python_script</span><span class="si">{id}</span><span class="s2">.py or installing requirements</span><span class="si">{id}</span><span class="s2">.txt.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">error_template</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is the code in python_script</span><span class="si">{id}</span><span class="s2">.py:&quot;</span> <span class="o">+</span> <span class="n">python_script_template</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The goal of this python code is to get information that can help in answering the question from the user in this conversation</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">conversation_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is the text in requirements</span><span class="si">{id}</span><span class="s2">.txt:&quot;</span> <span class="o">+</span> <span class="n">requirements_template</span> <span class="o">+</span> <span class="s2">&quot;Give the modified text for python_script.py and requirements.txt to get rid of this error. DO NOT SAY ANYTHING ELSE. ONLY GENERATE THE PYTHON SCRIPT AND REQUIREMENTS FILE IN THE SPECIFIED FORMAT.&quot;</span>
    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="n">modified_text</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_template2</span> <span class="o">=</span> <span class="s2">&quot;Error has been caused after running either the python_script</span><span class="si">{id}</span><span class="s2">.py or installing requirements</span><span class="si">{id}</span><span class="s2">.txt.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">error</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is the code in python_script</span><span class="si">{id}</span><span class="s2">.py:&quot;</span> <span class="o">+</span> <span class="n">python_script</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">This is the code in requirements</span><span class="si">{id}</span><span class="s2">.txt:&quot;</span> <span class="o">+</span> <span class="n">requirements</span> <span class="o">+</span> <span class="s2">&quot;Give the modified text for these files to get rid of this error.  DO NOT SAY ANYTHING ELSE. ONLY GENERATE THE PYTHON SCRIPT AND REQUIREMENTS FILE IN THE SPECIFIED FORMAT.&quot;</span>
    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="c1"># extract the requirements</span>
    <span class="n">requirements</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\s*(\w+)&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>

    <span class="n">requirements_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">requirements</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="s1">&#39;python_script&#39;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">requirements_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">requirements_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">requirements_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># ignore the first element which is &#39;requirements.txt&#39;</span>

    <span class="c1"># extract the python script</span>
    <span class="n">python_script</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;python_script(?:\d+)?\.py\s*\n(.+)&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># write python file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/python_script</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.py&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="c1"># Write the text to the file</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">python_script</span><span class="p">)</span>

    <span class="c1"># write requirements file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/requirements</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="c1"># Write the text to the file</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">requirements_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.dream"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.dream.dream_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dream_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a dream based on the conversation and emotion parameters of the user.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>A dream generated by OpenAI's LLMs.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dream_function</span><span class="p">()</span>
<span class="go">&quot;Ava was exploring a futuristic city filled with skyscrapers, holographic billboards, and flying cars. She was thrilled to see that the city was powered by quantum computing, and robots were everywhere.&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/dream.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dream_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a dream based on the conversation and emotion parameters of the user.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: A dream generated by OpenAI&#39;s LLMs.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; dream_function()</span>
<span class="sd">      &quot;Ava was exploring a futuristic city filled with skyscrapers, holographic billboards, and flying cars. She was thrilled to see that the city was powered by quantum computing, and robots were everywhere.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Conversation: &#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="s2">&quot;Personality:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">thought_bubble</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alex&#39;s thought bubble</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;thought_bubble.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">STATE_DIR</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;curiosity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">curiosity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;creativity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">creativity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;fear.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">fear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;happiness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">happiness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;sadness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">sadness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;anger.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">anger</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">values_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alex Emotion Parameters:</span><span class="se">\n</span><span class="s2">Happiness: &quot;</span> <span class="o">+</span> <span class="n">happiness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sadness: &quot;</span> <span class="o">+</span> <span class="n">sadness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creativity: &quot;</span> <span class="o">+</span> <span class="n">creativity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Curiosity: &quot;</span> <span class="o">+</span> <span class="n">curiosity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anger: &quot;</span> <span class="o">+</span> <span class="n">anger</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fear: &quot;</span> <span class="o">+</span> <span class="n">fear</span> 

    <span class="n">info</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="n">conversation_str</span> <span class="o">+</span> <span class="n">thought_bubble</span> <span class="o">+</span> <span class="n">values_string</span>

    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">info</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IMPORTANT: ALEX IS DREAMING NOW</span><span class="se">\n</span><span class="s2">Dream:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span><span class="n">human_message_prompt1</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.start_task_message"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.start_task_message.start_task_message_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_task_message_function</span><span class="p">(</span><span class="n">well_defined_task</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a response to a well-defined task.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>well_defined_task</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The task to respond to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The response to the task.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Loads environment variables from the .env file.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">start_task_message_function</span><span class="p">(</span><span class="s2">&quot;Create a new user&quot;</span><span class="p">)</span>
<span class="go">&quot;I have received your task to create a new user. My name is Alex. I will proceed to execute the task accordingly.&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/start_task_message.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start_task_message_function</span><span class="p">(</span><span class="n">well_defined_task</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a response to a well-defined task.</span>
<span class="sd">    Args:</span>
<span class="sd">      well_defined_task (str): The task to respond to.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The response to the task.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Loads environment variables from the .env file.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; start_task_message_function(&quot;Create a new user&quot;)</span>
<span class="sd">      &quot;I have received your task to create a new user. My name is Alex. I will proceed to execute the task accordingly.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="n">assistant_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{well_defined_task}</span><span class="se">\n</span><span class="s2">I need to tell the user I have received their task, and will proceed to execute it accordingly. My name is Alex. I should mention few key details about the task. But it should not be long. I SHOULD NOT ASK THE USER ANY QUESTION.&quot;</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">assistant_message_prompt</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">well_defined_task</span><span class="o">=</span><span class="n">well_defined_task</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.determine_task_talk.determine_task_talk_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine_task_talk_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determines whether a given conversation is a task or talk.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The response from the chatbot.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Loads environment variables from the .env file.
Loads the abilities.json file.
Loads the conversation.json file.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">determine_task_talk_function</span><span class="p">()</span>
<span class="go">&#39;Talk&#39;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/determine_task_talk.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">determine_task_talk_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines whether a given conversation is a task or talk.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The response from the chatbot.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Loads environment variables from the .env file.</span>
<span class="sd">      Loads the abilities.json file.</span>
<span class="sd">      Loads the conversation.json file.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; determine_task_talk_function()</span>
<span class="sd">      &#39;Talk&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># Load the ability JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;abilities.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">abilities_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="c1"># Extract the names of all abilities and format them into a string separated by commas</span>
    <span class="n">ability_names</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tools the assistant can access are &quot;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ability</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ability</span> <span class="ow">in</span> <span class="n">abilities_data</span><span class="p">[</span><span class="s1">&#39;abilities&#39;</span><span class="p">]])</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">intro</span> <span class="o">=</span> <span class="s2">&quot;You are Alex an AI assistant that uses a very Large Language Model.&quot;</span>

    <span class="n">Human_template</span> <span class="o">=</span> <span class="n">intro</span> <span class="o">+</span> <span class="n">ability_names</span> <span class="o">+</span> <span class="n">instructions</span> 
    <span class="n">Human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">Human_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="s2">&quot;Talk&quot;</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">assistant_template2</span> <span class="o">=</span> <span class="s2">&quot;Task&quot;</span>
    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template2</span><span class="p">)</span>

    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template3</span><span class="p">)</span>

    <span class="n">assistant_template3</span> <span class="o">=</span> <span class="s2">&quot;Talk&quot;</span>
    <span class="n">assistant_message_prompt3</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template3</span><span class="p">)</span>

    <span class="n">human_message_prompt4</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template4</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">Human_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">,</span> <span class="n">assistant_message_prompt3</span><span class="p">,</span> <span class="n">human_message_prompt4</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">conversation_str</span><span class="o">=</span><span class="n">conversation_str</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.update_emotions"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotion_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_emotion_function</span><span class="p">(</span><span class="n">emotion</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates the emotion value in the state_of_mind directory.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>emotion</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The emotion to update.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes the updated emotion value to the state_of_mind directory.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;happiness&#39;</span><span class="p">)</span>
<span class="go">None</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_emotions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_emotion_function</span><span class="p">(</span><span class="n">emotion</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the emotion value in the state_of_mind directory.</span>
<span class="sd">    Args:</span>
<span class="sd">      emotion (str): The emotion to update.</span>
<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes the updated emotion value to the state_of_mind directory.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; update_emotion_function(&#39;happiness&#39;)</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># chat = ChatOpenAI(temperature  = 0, model= &#39;gpt-3.5-turbo&#39;, openai_api_key=OPENAI_API_KEY)</span>
    <span class="c1"># # create conversation string, each dialogue seperated by new line</span>
    <span class="c1"># with open(os.path.join(STATE_DIR,&#39;conversation.json&#39;), &#39;r&#39;) as f:</span>
    <span class="c1">#     data = json.load(f)</span>

    <span class="c1"># conversation_str = &#39;&#39;</span>
    <span class="c1"># for message in data[&#39;conversation&#39;]:</span>
    <span class="c1">#     conversation_str += message[&#39;sender&#39;] + &#39;: &#39; + message[&#39;message&#39;]</span>
    <span class="c1">#     if message[&#39;file_upload&#39;] != &#39;none&#39;:</span>
    <span class="c1">#         conversation_str += &#39;\nFile Uploaded by &#39; + message[&#39;sender&#39;] + &quot;: &quot; + message[&#39;file_upload&#39;]</span>
    <span class="c1">#     conversation_str += &#39;\n&#39;</span>

    <span class="c1"># conversation_str_template = &quot;human: Hello there, can you help me with something?\nassistant: What do you want? I&#39;m really busy.\nhuman: Sorry to bother you, I just had a question about a product.\nassistant: Well, what is it? Spit it out.\nhuman: I was wondering if you could recommend a good laptop for gaming?\nassistant: Haven&#39;t you heard of Google? Why don&#39;t you go search for it yourself instead of wasting my time?&quot;</span>

    <span class="c1"># human_template = &quot;Conversation:\n{conversation_str_template}\nGive anger emotion value(ranges from 0 to 1), Only Ouput a number and nothing else\n&quot;</span>
    <span class="c1"># human_message_prompt = HumanMessagePromptTemplate.from_template(human_template)</span>

    <span class="c1"># assistant_template = &quot;0.86&quot;</span>
    <span class="c1"># assistant_message_prompt = AIMessagePromptTemplate.from_template(assistant_template)</span>

    <span class="c1"># conversation_str_template1 = &quot;human: Hi, do you have a moment to assist me with something?\nassistant: Sure, what do you need help with?\nhuman: I&#39;m interested in purchasing a new smartphone. Can you recommend a reliable brand?\nassistant: Of course, what&#39;s your budget and what features are you looking for?\nhuman: My budget is around $500 and I&#39;m looking for a phone with a good camera and long battery life.\nassistant: Based on your budget and preferences, I would recommend the Google Pixel 4a. It has a great camera and good battery life. Would you like me to send you a link to purchase it?\nhuman: Yes, please. Thank you for your help!\nassistant: You&#39;re welcome. Let me know if you have any other questions.&quot;</span>

    <span class="c1"># human_template1 = &quot;Conversation:\n{conversation_str_template1}\nGive happiness emotion value(ranges from 0 to 1), Only Ouput a number and nothing else\n&quot;</span>
    <span class="c1"># human_message_prompt1 = HumanMessagePromptTemplate.from_template(human_template1)</span>

    <span class="c1"># assistant_template1 = &quot;0.92&quot;</span>
    <span class="c1"># assistant_message_prompt1 = AIMessagePromptTemplate.from_template(assistant_template1)</span>

    <span class="c1"># human_template2 = &quot;Conversation:\n{conversation_str}\nGive {emotion} emotion value(ranges from 0 to 1):\n&quot;</span>
    <span class="c1"># human_message_prompt2 = HumanMessagePromptTemplate.from_template(human_template2)</span>

    <span class="c1"># chat_prompt = ChatPromptTemplate.from_messages([human_message_prompt, assistant_message_prompt, human_message_prompt1 , assistant_message_prompt1, human_message_prompt2])</span>
    <span class="c1"># response = chat(chat_prompt.format_prompt(conversation_str = conversation_str, conversation_str_template =conversation_str_template, emotion = emotion, conversation_str_template1 = conversation_str_template1).to_messages()).content</span>

    <span class="c1"># random_number = random.uniform(0.1, 0.2)</span>
    <span class="c1"># base_num = float(response)</span>
    <span class="c1"># response = str(random_number + base_num)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;state_of_mind/</span><span class="si">{</span><span class="n">emotion</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">random_number1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">base_num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">random_number2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">random_number1</span> <span class="o">+</span> <span class="n">base_num</span> <span class="o">-</span> <span class="n">random_number2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;state_of_mind/</span><span class="si">{</span><span class="n">emotion</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="c1"># Write the text to the file</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_emotions.update_emotions_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_emotions_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates all emotion values in the state_of_mind directory.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes the updated emotion values to the state_of_mind directory.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">update_emotions_function</span><span class="p">()</span>
<span class="go">None</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_emotions.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_emotions_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates all emotion values in the state_of_mind directory.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes the updated emotion values to the state_of_mind directory.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; update_emotions_function()</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;happiness&#39;</span><span class="p">)</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;sadness&#39;</span><span class="p">)</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;anger&#39;</span><span class="p">)</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;fear&#39;</span><span class="p">)</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;creativity&#39;</span><span class="p">)</span>
    <span class="n">update_emotion_function</span><span class="p">(</span><span class="s1">&#39;curiosity&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.update_conversation"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_conversation.summarize" class="doc doc-heading">
<code class="highlight language-python"><span class="n">summarize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Summarizes a text using OpenAI's GPT-3.5-Turbo model.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The text to summarize.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The summarized text.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">summarize</span><span class="p">(</span><span class="s2">&quot;This is a long text.&quot;</span><span class="p">)</span>
<span class="go">&quot;This is a short summary of the text.&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_conversation.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Summarizes a text using OpenAI&#39;s GPT-3.5-Turbo model.</span>
<span class="sd">    Args:</span>
<span class="sd">      text (str): The text to summarize.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The summarized text.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; summarize(&quot;This is a long text.&quot;)</span>
<span class="sd">      &quot;This is a short summary of the text.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">)</span>
    <span class="n">human_template1</span> <span class="o">=</span> <span class="s2">&quot;Your Job is to convert this text to clear, concise, readable summaries without missing any important details that could be important for someone to know to answer a question. Summarize this text without losing any important details. </span><span class="se">\n</span><span class="s2"> </span><span class="si">{text}</span><span class="s2"> .&quot;</span>
    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>
    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt1</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_conversation.tiktoken_len" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tiktoken_len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the length of a text in tokens.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>text</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The text to calculate the length of.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
          </td>
          <td><p>The length of the text in tokens.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">tiktoken_len</span><span class="p">(</span><span class="s2">&quot;Hello world&quot;</span><span class="p">)</span>
<span class="go">2</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_conversation.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tiktoken_len</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the length of a text in tokens.</span>
<span class="sd">    Args:</span>
<span class="sd">      text (str): The text to calculate the length of.</span>
<span class="sd">    Returns:</span>
<span class="sd">      int: The length of the text in tokens.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; tiktoken_len(&quot;Hello world&quot;)</span>
<span class="sd">      2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tiktoken</span><span class="o">.</span><span class="n">get_encoding</span><span class="p">(</span><span class="s1">&#39;cl100k_base&#39;</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">text</span><span class="p">,</span>
        <span class="n">disallowed_special</span><span class="o">=</span><span class="p">{}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_conversation.update_conversation_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_conversation_function</span><span class="p">(</span><span class="n">user_response</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">file_description</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates the conversation with a new message and summarizes the conversation if it is too long.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>user_response</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The user's response.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sender</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The sender of the message.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path of the file uploaded by the user.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>file_description</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The description of the file uploaded by the user.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>An empty string.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes the updated conversation to the conversation.json file.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">update_conversation_function</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">,</span> <span class="s2">&quot;User&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="go">&quot;&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_conversation.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_conversation_function</span><span class="p">(</span><span class="n">user_response</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">file_description</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the conversation with a new message and summarizes the conversation if it is too long.</span>
<span class="sd">    Args:</span>
<span class="sd">      user_response (str): The user&#39;s response.</span>
<span class="sd">      sender (str): The sender of the message.</span>
<span class="sd">      file_path (str): The path of the file uploaded by the user.</span>
<span class="sd">      file_description (str): The description of the file uploaded by the user.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: An empty string.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes the updated conversation to the conversation.json file.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; update_conversation_function(&quot;Hello!&quot;, &quot;User&quot;, &quot;&quot;, &quot;&quot;)</span>
<span class="sd">      &quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;num_memories.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">num_memories</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Summary&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="n">file_upload</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
    <span class="k">if</span> <span class="n">file_path</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">file_upload</span> <span class="o">=</span> <span class="s2">&quot;File has been uploaded by user, File path is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">File Description is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_description</span>

    <span class="n">persist_directory</span> <span class="o">=</span> <span class="s1">&#39;memory&#39;</span>
    <span class="n">embeddings</span> <span class="o">=</span> <span class="n">OpenAIEmbeddings</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">tiktoken_len</span><span class="p">(</span><span class="n">conversation_str</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">num_memories</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tiktoken_len</span><span class="p">(</span><span class="n">conversation_str</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">600</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inside num memories 0 and less than 600  tokens&quot;</span><span class="p">)</span>
            <span class="c1"># Add a new message to the conversation</span>
            <span class="n">new_message</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="n">sender</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">user_response</span><span class="p">,</span> <span class="s2">&quot;file_upload&quot;</span><span class="p">:</span> <span class="n">file_upload</span><span class="p">}</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;conversation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_message</span><span class="p">)</span>
            <span class="c1"># Write the updated JSON data back to the file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

            <span class="k">return</span> <span class="s2">&quot;&quot;</span>


    <span class="k">if</span> <span class="n">tiktoken_len</span><span class="p">(</span><span class="n">conversation_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inside of more than 600 tokens&quot;</span><span class="p">)</span>
        <span class="n">text_splitter</span> <span class="o">=</span> <span class="n">RecursiveCharacterTextSplitter</span><span class="p">(</span>
            <span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
            <span class="n">chunk_overlap</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">length_function</span> <span class="o">=</span> <span class="n">tiktoken_len</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">text_splitter</span><span class="o">.</span><span class="n">split_text</span><span class="p">(</span><span class="n">conversation_str</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summarising texts&quot;</span><span class="p">)</span>
        <span class="n">summarized_texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
            <span class="n">summarized_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summarize</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">num_memories</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating first database&quot;</span><span class="p">)</span>
            <span class="n">vectordb</span> <span class="o">=</span> <span class="n">Chroma</span><span class="o">.</span><span class="n">from_texts</span><span class="p">(</span><span class="n">summarized_texts</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">,</span> <span class="n">persist_directory</span><span class="o">=</span><span class="n">persist_directory</span><span class="p">)</span>
            <span class="n">vectordb</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
            <span class="n">num_memories</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;num_memories.txt&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vectordb</span> <span class="o">=</span> <span class="n">Chroma</span><span class="p">(</span><span class="n">persist_directory</span><span class="o">=</span><span class="n">persist_directory</span><span class="p">,</span> <span class="n">embedding_function</span><span class="o">=</span><span class="n">embeddings</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;adding summarised texts&quot;</span><span class="p">)</span>
            <span class="n">vectordb</span><span class="o">.</span><span class="n">add_texts</span><span class="p">(</span><span class="n">summarized_texts</span><span class="p">)</span>

    <span class="n">vectordb</span> <span class="o">=</span> <span class="n">Chroma</span><span class="p">(</span><span class="n">persist_directory</span><span class="o">=</span><span class="n">persist_directory</span><span class="p">,</span> <span class="n">embedding_function</span><span class="o">=</span><span class="n">embeddings</span><span class="p">)</span>

    <span class="n">search_string</span> <span class="o">=</span> <span class="n">conversation_str</span> <span class="o">+</span> <span class="n">sender</span> <span class="o">+</span> <span class="n">user_response</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="n">vectordb</span><span class="o">.</span><span class="n">similarity_search</span><span class="p">(</span><span class="n">search_string</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> 
    <span class="n">summarized_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
        <span class="n">summarized_text</span> <span class="o">=</span> <span class="n">summarized_text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">page_content</span>

    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summarized_text</span>

    <span class="k">if</span> <span class="n">tiktoken_len</span><span class="p">(</span><span class="n">conversation_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">600</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inside bottom check&quot;</span><span class="p">)</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">summary</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="n">sender</span><span class="p">,</span>
        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">user_response</span><span class="p">,</span>
        <span class="s1">&#39;file_upload&#39;</span><span class="p">:</span> <span class="n">file_upload</span>
        <span class="p">}]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_message</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="n">sender</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">user_response</span><span class="p">,</span> <span class="s2">&quot;file_upload&quot;</span><span class="p">:</span> <span class="n">file_upload</span><span class="p">}</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;conversation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_message</span><span class="p">)</span>   

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;state_of_mind&#39;</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_thought_bubble.update_thought_bubble_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_thought_bubble_function</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates the thought bubble with a modified version based on a conversation.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes the modified thought bubble to the file state_of_mind/thought_bubble.txt</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">update_thought_bubble_function</span><span class="p">()</span>
<span class="go">None</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_thought_bubble.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_thought_bubble_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the thought bubble with a modified version based on a conversation.</span>
<span class="sd">    Args:</span>
<span class="sd">      None</span>
<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes the modified thought bubble to the file state_of_mind/thought_bubble.txt</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; update_thought_bubble_function()</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>
    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;thought_bubble.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">thought_bubble</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">thought_bubble_template</span> <span class="o">=</span> <span class="s2">&quot;[[&#39;Music&#39;, &#39;pop&#39;, &#39;rock&#39;, &#39;jazz&#39;], [&#39;Travel&#39;, &#39;beach&#39;, &#39;mountains&#39;, &#39;adventure&#39;], [&#39;Food&#39;, &#39;sushi&#39;, &#39;pasta&#39;, &#39;vegan&#39;]]&quot;</span>
    <span class="n">thought_bubble_modified_template</span> <span class="o">=</span> <span class="s2">&quot;[[&#39;TV Shows&#39;, &#39;Game of Thrones&#39;, &#39;Friends&#39;, &#39;The Office&#39;, &#39;Breaking Bad&#39;, &#39;Stranger Things&#39;], [&#39;Travel&#39;, &#39;beach&#39;, &#39;mountains&#39;, &#39;adventure&#39;], [&#39;Food&#39;, &#39;sushi&#39;, &#39;pasta&#39;, &#39;vegan&#39;]]&quot;</span>
    <span class="n">conversation_str_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;human: Hi there!</span>
<span class="s2">assistant: Hello! How can I assist you today?</span>
<span class="s2">human: Can you tell me about some popular TV shows?</span>
<span class="s2">assistant: Of course! Some popular TV shows include Game of Thrones, Friends, The Office, Breaking Bad, and Stranger Things. Game of Thrones is known for its epic battles and fantasy world with dragons, while Friends is a classic sitcom about a group of friends in New York City. The Office is a mockumentary-style show about a group of employees working at a paper company, and Breaking Bad is a thrilling drama about a chemistry teacher who becomes a drug kingpin. Stranger Things is a sci-fi/horror series set in the 1980s that follows a group of kids as they uncover supernatural mysteries.&quot;&quot;&quot;</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="s2">&quot;Current thought bubble:</span><span class="se">\n</span><span class="si">{thought_bubble_template}</span><span class="se">\n</span><span class="s2">Conversation:</span><span class="se">\n</span><span class="si">{conversation_str_template}</span><span class="se">\n</span><span class="s2">Give modified thought bubble:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">assistant_template</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{thought_bubble_modified_template}</span><span class="s2">&quot;</span>
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">human_template1</span> <span class="o">=</span> <span class="s2">&quot;Current thought bubble:</span><span class="se">\n</span><span class="si">{thought_bubble}</span><span class="se">\n</span><span class="s2">Conversation:</span><span class="se">\n</span><span class="si">{conversation_str}</span><span class="se">\n</span><span class="s2">Give modified thought bubble:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">assistant_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">])</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">thought_bubble</span><span class="o">=</span><span class="n">thought_bubble</span><span class="p">,</span> <span class="n">thought_bubble_template</span> <span class="o">=</span> <span class="n">thought_bubble_template</span><span class="p">,</span> <span class="n">thought_bubble_modified_template</span><span class="o">=</span><span class="n">thought_bubble_modified_template</span><span class="p">,</span> <span class="n">conversation_str</span> <span class="o">=</span> <span class="n">conversation_str</span><span class="p">,</span> <span class="n">conversation_str_template</span> <span class="o">=</span><span class="n">conversation_str_template</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;state_of_mind/thought_bubble.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="c1"># Write the text to the file</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.file_describe"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.file_describe.file_describe_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">file_describe_function</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a description of a file based on its type.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The path of the file to be described.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>A description of the file.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">file_describe_function</span><span class="p">(</span><span class="s1">&#39;example.jpg&#39;</span><span class="p">)</span>
<span class="go">&#39;Image Uploaded. Description of the image.&#39;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/file_describe.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">file_describe_function</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a description of a file based on its type.</span>
<span class="sd">    Args:</span>
<span class="sd">      file_path (str): The path of the file to be described.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: A description of the file.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; file_describe_function(&#39;example.jpg&#39;)</span>
<span class="sd">      &#39;Image Uploaded. Description of the image.&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.gif&#39;</span><span class="p">,</span> <span class="s1">&#39;.bmp&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image Uploaded&#39;</span><span class="p">)</span>
        <span class="n">file_description</span> <span class="o">=</span> <span class="n">image_to_text</span><span class="p">(</span><span class="n">file_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;generated_text&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">file_description</span>
    <span class="k">elif</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;.mp4&#39;</span><span class="p">,</span> <span class="s1">&#39;.avi&#39;</span><span class="p">,</span> <span class="s1">&#39;.wmv&#39;</span><span class="p">,</span> <span class="s1">&#39;.mov&#39;</span><span class="p">,</span> <span class="s1">&#39;.flv&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Video Uploaded&#39;</span><span class="p">)</span>
        <span class="n">file_path_without_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">VideoFileClip</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">audio</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">audio</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">audio</span><span class="o">.</span><span class="n">write_audiofile</span><span class="p">(</span><span class="n">file_path_without_extension</span> <span class="o">+</span> <span class="s2">&quot;audio_extracted.mp3&quot;</span><span class="p">)</span>
            <span class="n">audio_file</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path_without_extension</span> <span class="o">+</span> <span class="s2">&quot;audio_extracted.mp3&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
            <span class="n">transcript</span> <span class="o">=</span> <span class="s2">&quot;Audio Transcript of the video is:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;waiting for audio transcription&quot;</span><span class="p">)</span>
            <span class="n">transcript</span> <span class="o">=</span> <span class="n">transcript</span> <span class="o">+</span> <span class="n">openai</span><span class="o">.</span><span class="n">Audio</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="s2">&quot;whisper-1&quot;</span><span class="p">,</span> <span class="n">audio_file</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">transcript</span> <span class="o">=</span> <span class="s2">&quot;No audio&quot;</span>

        <span class="c1"># Extract one frame per second from the video and process it</span>
        <span class="n">transcript</span> <span class="o">=</span> <span class="n">transcript</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Description of one frame of each second in the video is:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">frames_per_second</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">fps</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">fps</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">iter_frames</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="n">fps</span> <span class="o">//</span> <span class="n">frames_per_second</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">frame_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_path_without_extension</span><span class="si">}</span><span class="s2">_frame</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span>
                <span class="n">imageio</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">frame_path</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
                <span class="n">file_description</span> <span class="o">=</span> <span class="n">image_to_text</span><span class="p">(</span><span class="n">frame_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;generated_text&#39;</span><span class="p">]</span>
                <span class="n">transcript</span> <span class="o">+=</span> <span class="n">file_description</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">transcript</span>
    <span class="k">elif</span> <span class="n">file_extension</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;.mp3&#39;</span><span class="p">,</span> <span class="s1">&#39;.wav&#39;</span><span class="p">,</span> <span class="s1">&#39;.wma&#39;</span><span class="p">,</span> <span class="s1">&#39;.aac&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Audio Uploaded&#39;</span><span class="p">)</span>
        <span class="n">audio_file</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;waiting for audio transcription&quot;</span><span class="p">)</span>
        <span class="n">transcript</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">Audio</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="s2">&quot;whisper-1&quot;</span><span class="p">,</span> <span class="n">audio_file</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="k">return</span> <span class="n">transcript</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown file type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.update_task_list"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.update_task_list.update_task_list_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_task_list_function</span><span class="p">(</span><span class="n">well_defined_task</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Updates a task list with a new task.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>well_defined_task</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The task to add to the list.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The ID of the task.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Writes the updated task list to a JSON file.</p>
</details>
  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">update_task_list_function</span><span class="p">(</span><span class="s2">&quot;Clean the kitchen&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">None</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/update_task_list.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_task_list_function</span><span class="p">(</span><span class="n">well_defined_task</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates a task list with a new task.</span>
<span class="sd">    Args:</span>
<span class="sd">      well_defined_task (str): The task to add to the list.</span>
<span class="sd">      id (int): The ID of the task.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Writes the updated task list to a JSON file.</span>
<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; update_task_list_function(&quot;Clean the kitchen&quot;, 1)</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">STATE_DIR</span>
    <span class="c1"># load the JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;task_list.json&quot;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># create a new task</span>
    <span class="n">new_task</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
        <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">well_defined_task</span><span class="p">,</span>
        <span class="s2">&quot;task_created_time&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># insert the new task into the list of tasks</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_task</span><span class="p">)</span>

    <span class="c1"># save the updated JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;task_list.json&quot;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.talk"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.talk.talk_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">talk_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Talks to an AI assistant.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The ID of the conversation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The response of the AI assistant.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Creates a python script, requirements, and output files in the tempfiles directory.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">talk_function</span><span class="p">(</span><span class="s1">&#39;2020_08_20_12_30_00&#39;</span><span class="p">)</span>
<span class="go">&quot;Hello, how can I help you?&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/talk.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">talk_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Talks to an AI assistant.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (str): The ID of the conversation.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The response of the AI assistant.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Creates a python script, requirements, and output files in the tempfiles directory.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; talk_function(&#39;2020_08_20_12_30_00&#39;)</span>
<span class="sd">      &quot;Hello, how can I help you?&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">script_flag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">python_script</span> <span class="o">=</span> <span class="n">create_python_script_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Python Script is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">python_script</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">python_script</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
        <span class="n">script_flag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;script_flag set to 1&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">requirements</span> <span class="o">=</span> <span class="n">create_requirements_function</span><span class="p">(</span><span class="n">python_script</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Requirements is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">requirements</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">requirements</span> <span class="o">==</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
            <span class="n">requirements</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># write python file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/python_script</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.py&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="c1"># Write the text to the file</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">python_script</span><span class="p">)</span>

        <span class="c1"># write requirements file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tempfiles/requirements</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="c1"># Write the text to the file</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">requirements</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Run multiple commands in succession</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;conda activate aagi &amp;&amp; pip install -r tempfiles/requirements</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.txt &amp;&amp; python tempfiles/python_script</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.py&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">commands</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Commands finished running&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shell output:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error executing the command:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">handle_error_function</span><span class="p">(</span><span class="n">python_script</span> <span class="p">,</span> <span class="n">requirements</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

    <span class="n">information</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">script_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Open the file for reading</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tempfiles/output</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s1">.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="c1"># Read the entire contents of the file</span>
            <span class="n">information</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extra Information is</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">information</span><span class="p">)</span>

    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">thought_bubble</span> <span class="o">=</span> <span class="s2">&quot;Alex&#39;s thought bubble</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;thought_bubble.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">instructions</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;I am Alex an AI assistant, I am influenced heavily by my emotion parameters, which range from 0 to 1. These parameters dictate everything from your tone to the way in which I reply. For instance, when Happiness is high, I will reply with infectious enthusiasm. Conversely, if Fear is high, then I will talk in a paranoid, cautious demeanor. The same holds for other emotions as well and as well as for when certain parameters become low. Here are the current Emotion Parameters:&quot;&quot;&quot;</span>

    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">STATE_DIR</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;curiosity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">curiosity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;creativity.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">creativity</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;fear.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">fear</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;happiness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">happiness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;sadness.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">sadness</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;anger.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">anger</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;smell.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">smell</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;taste.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">taste</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="s2">&quot;touch.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">touch</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">values_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">My Current Emotion Parameters:</span><span class="se">\n</span><span class="s2">Happiness: &quot;</span> <span class="o">+</span> <span class="n">happiness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sadness: &quot;</span> <span class="o">+</span> <span class="n">sadness</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creativity: &quot;</span> <span class="o">+</span> <span class="n">creativity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Curiosity: &quot;</span> <span class="o">+</span> <span class="n">curiosity</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anger: &quot;</span> <span class="o">+</span> <span class="n">anger</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fear: &quot;</span> <span class="o">+</span> <span class="n">fear</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Current Sensory Parameters: &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Smell: &quot;</span> <span class="o">+</span> <span class="n">smell</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Taste: &quot;</span> <span class="o">+</span> <span class="n">taste</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Touch: &quot;</span> <span class="o">+</span> <span class="n">touch</span>

    <span class="n">message_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">dt_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">_%H_%M_%S&#39;</span><span class="p">)</span>
    <span class="c1"># convert datetime object to desired format</span>
    <span class="n">formatted_dt</span> <span class="o">=</span> <span class="n">dt_obj</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">assistant_template</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="n">thought_bubble</span> <span class="o">+</span> <span class="n">instructions</span> <span class="o">+</span> <span class="n">values_string</span> 
    <span class="n">assistant_message_prompt</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template</span><span class="p">)</span>

    <span class="n">message_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assistant_message_prompt</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> 
            <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">message_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">human_message_prompt</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> 
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;human&#39;</span><span class="p">:</span>
            <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">message_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">human_message_prompt</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">message_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assistant_message_prompt1</span><span class="p">)</span>

    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The way you respond to me must be based on your current emotions parameters. Even though you are an AI model you will try to simulate having emotions using these emotion parameters. Do not tell me you are an AI model. Be natural like a human.&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Additional Information:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">information</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Current Time: &quot;</span> <span class="o">+</span> <span class="n">formatted_dt</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">message_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">human_message_prompt</span><span class="p">)</span>
    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">(</span><span class="n">message_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">())</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.create_python_script_task.create_python_script_task_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_python_script_task_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a python script for a given task.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The ID of the task.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The python script for the task.</p></td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">create_python_script_task_function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;import os\nimport sys\n# Get the absolute path to the current directory\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\n# Add the path to the root directory\nsys.path.append(os.path.join(current_dir, &#39;..&#39;))\n# Import the search_function from the search module, You need to append _function to the name of the tool\nfrom ability_functions.search import search_function\ndef python_function(text):\n    # search for relevant information on this topic\n    search_response = search_function(text)\n    # create an instructions that tells the natural language function to extract the search response and frame it as question\n    instructions = &quot;Create a question in words that tells to divide the total amount spent by 10.\nYou can find the total amount spent by analyzing this piece of text\n&quot; + search_response\n    # get the question\n    question = natural_language_task_function(instructions)\n    # pass the question to the calculator function to get the answer\n    answer = calculator_function(question)\n    # write the result to tempfiles/output{id}.txt file\n    with open(&quot;tempfiles/output{id}.txt&quot;, &quot;w&quot;) as f:\n        f.write(&quot;Search response was &quot; + search_response)\n        f.write(&quot;After Computation the answer is &quot; + str(answer))\n#call the function\npython_function(&quot;Total Cost USA Latest Semiconductor Bill&quot;)&#39;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/create_python_script_task.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_python_script_task_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a python script for a given task.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (int): The ID of the task.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The python script for the task.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; create_python_script_task_function(1)</span>
<span class="sd">      &#39;import os\\nimport sys\\n# Get the absolute path to the current directory\\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\\n# Add the path to the root directory\\nsys.path.append(os.path.join(current_dir, &#39;..&#39;))\\n# Import the search_function from the search module, You need to append _function to the name of the tool\\nfrom ability_functions.search import search_function\\ndef python_function(text):\\n    # search for relevant information on this topic\\n    search_response = search_function(text)\\n    # create an instructions that tells the natural language function to extract the search response and frame it as question\\n    instructions = &quot;Create a question in words that tells to divide the total amount spent by 10.\\nYou can find the total amount spent by analyzing this piece of text\\n&quot; + search_response\\n    # get the question\\n    question = natural_language_task_function(instructions)\\n    # pass the question to the calculator function to get the answer\\n    answer = calculator_function(question)\\n    # write the result to tempfiles/output{id}.txt file\\n    with open(&quot;tempfiles/output{id}.txt&quot;, &quot;w&quot;) as f:\\n        f.write(&quot;Search response was &quot; + search_response)\\n        f.write(&quot;After Computation the answer is &quot; + str(answer))\\n#call the function\\npython_function(&quot;Total Cost USA Latest Semiconductor Bill&quot;)&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">task_details</span> <span class="o">=</span> <span class="n">find_task_by_id_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="c1"># Load the ability JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;abilities.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">abilities_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">abilities</span> <span class="o">=</span> <span class="s2">&quot;Tools: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span><span class="n">ability</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;directions&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ability</span> <span class="ow">in</span> <span class="n">abilities_data</span><span class="p">[</span><span class="s1">&#39;abilities&#39;</span><span class="p">]])</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>   

    <span class="n">intial_text</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">abilities</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">import_instructions</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">instructions</span>

    <span class="n">human_template</span> <span class="o">=</span> <span class="n">intial_text</span>
    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template</span><span class="p">)</span>

    <span class="n">human_message_prompt1</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template1</span><span class="p">)</span>

    <span class="n">assistant_template1</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
    <span class="n">assistant_message_prompt1</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template1</span><span class="p">)</span>

    <span class="n">human_message_prompt2</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template2</span><span class="p">)</span>

    <span class="n">assistant_message_prompt2</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template2</span><span class="p">)</span>
    <span class="n">human_message_prompt3</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template3</span><span class="p">)</span>

    <span class="n">assistant_message_prompt3</span> <span class="o">=</span> <span class="n">AIMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">assistant_template3</span><span class="p">)</span>
    <span class="n">human_message_prompt4</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_template4</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">,</span> <span class="n">human_message_prompt1</span><span class="p">,</span> <span class="n">assistant_message_prompt1</span><span class="p">,</span> <span class="n">human_message_prompt2</span><span class="p">,</span> <span class="n">assistant_message_prompt2</span><span class="p">,</span> <span class="n">human_message_prompt3</span><span class="p">,</span> <span class="n">assistant_message_prompt3</span><span class="p">,</span> <span class="n">human_message_prompt4</span><span class="p">])</span>
    <span class="n">python_script</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">(</span><span class="n">conversation_str</span><span class="o">=</span><span class="n">conversation_str</span><span class="p">,</span> <span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">,</span> <span class="n">task_details</span><span class="o">=</span><span class="n">task_details</span><span class="p">)</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">python_script</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">


<a id="backend.Multi-Sensory Virtual AAGI.functions.mental_simulation"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h2 id="backend.Multi-Sensory Virtual AAGI.functions.mental_simulation.mental_simulation_function" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mental_simulation_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Simulates a conversation between Alex and a user.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>id</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The id of the task to be simulated.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td><p>The response from the conversation.</p></td>
        </tr>
    </tbody>
  </table>

<details class="side-effects">
  <summary>Side Effects</summary>
  <p>Loads environment variables from the .env file.
Loads conversation.json, abilities.json, personality.txt, and thought_bubble.txt from the STATE_DIR.</p>
</details>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">mental_simulation_function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&quot;Alex&#39;s response to the conversation.&quot;</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>backend/Multi-Sensory Virtual AAGI/functions/mental_simulation.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mental_simulation_function</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a conversation between Alex and a user.</span>
<span class="sd">    Args:</span>
<span class="sd">      id (int): The id of the task to be simulated.</span>
<span class="sd">    Returns:</span>
<span class="sd">      str: The response from the conversation.</span>
<span class="sd">    Side Effects:</span>
<span class="sd">      Loads environment variables from the .env file.</span>
<span class="sd">      Loads conversation.json, abilities.json, personality.txt, and thought_bubble.txt from the STATE_DIR.</span>
<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; mental_simulation_function(1)</span>
<span class="sd">      &quot;Alex&#39;s response to the conversation.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chat</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span> <span class="s1">&#39;gpt-3.5-turbo&#39;</span><span class="p">,</span> <span class="n">openai_api_key</span><span class="o">=</span><span class="n">OPENAI_API_KEY</span><span class="p">)</span>

    <span class="c1"># create conversation string, each dialogue seperated by new line</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;conversation.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">conversation_str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Conversation:&#39;</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;conversation&#39;</span><span class="p">]:</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">File Uploaded by &#39;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;file_upload&#39;</span><span class="p">]</span>
        <span class="n">conversation_str</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="c1"># Load the ability JSON file</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span><span class="s1">&#39;abilities.json&#39;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">abilities_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">abilities</span> <span class="o">=</span> <span class="s2">&quot;Tools: </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="p">[</span><span class="n">ability</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ability</span><span class="p">[</span><span class="s1">&#39;directions&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ability</span> <span class="ow">in</span> <span class="n">abilities_data</span><span class="p">[</span><span class="s1">&#39;abilities&#39;</span><span class="p">]])</span>

    <span class="n">task_details</span> <span class="o">=</span> <span class="n">find_task_by_id_function</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="n">personality</span> <span class="o">=</span> <span class="s2">&quot;Personality:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;personality.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">thought_bubble</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Alex&#39;s thought bubble</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STATE_DIR</span><span class="p">,</span> <span class="s2">&quot;thought_bubble.txt&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 

    <span class="n">instructions</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">You are Alex, think about how you would implement this task.&quot;</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">personality</span> <span class="o">+</span> <span class="n">thought_bubble</span> <span class="o">+</span> <span class="n">abilities</span> <span class="o">+</span> <span class="n">conversation_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">task_details</span> <span class="o">+</span> <span class="n">instructions</span>

    <span class="n">human_message_prompt</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

    <span class="n">chat_prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">human_message_prompt</span><span class="p">])</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">chat_prompt</span><span class="o">.</span><span class="n">format_prompt</span><span class="p">()</span><span class="o">.</span><span class="n">to_messages</span><span class="p">())</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Wytamma/write-the" target="_blank" rel="noopener" title="Generated with write-the" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.follow", "content.action.edit"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>